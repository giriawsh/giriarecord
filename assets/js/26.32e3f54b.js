(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{375:function(v,_,t){"use strict";t.r(_);var s=t(42),a=Object(s.a)({},(function(){var v=this,_=v.$createElement,t=v._self._c||_;return t("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[t("h2",{attrs:{id:"✍️前言"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#✍️前言"}},[v._v("#")]),v._v(" ✍️前言")]),v._v(" "),t("p",[v._v("《JS权威指南》学习笔记第三章第三部分，涉及变量声明、变量作用域、作用域链等内容")]),v._v(" "),t("h2",{attrs:{id:"_1-变量声明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-变量声明"}},[v._v("#")]),v._v(" 1. 变量声明")]),v._v(" "),t("p",[v._v("在JS中，使用一个变量之前应用var来声明，也可以将初始赋值和变量声明合写一起。")]),v._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[v._v("var i = 0, j = 0;\n")])]),v._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[v._v("1")]),t("br")])]),t("p",[v._v("如果未指定初始值，它的初始值为undefined")]),v._v(" "),t("p",[v._v("JS变量可以是任意数据类型（轻量级的优点基础）")]),v._v(" "),t("h3",{attrs:{id:"重复声明和遗漏声明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#重复声明和遗漏声明"}},[v._v("#")]),v._v(" 重复声明和遗漏声明")]),v._v(" "),t("ul",[t("li",[t("p",[v._v("使用var语句重复声明变量是合法且无害的。")])]),v._v(" "),t("li",[t("p",[v._v("如果试图读取一个没有声明的变量的值，JS会报错。")])]),v._v(" "),t("li",[t("p",[v._v("ES5严格模式下，给一个没有声明的变量赋值也会报错")])]),v._v(" "),t("li",[t("p",[v._v("非严格模式下，给一个没有声明的变量赋值，实际上会给全局对象创建一个同名属性，使它工作起来像一个正确声明的全局变量（后文会看到区别）")])])]),v._v(" "),t("p",[v._v("总之别有什么坏习惯，该声明声明。")]),v._v(" "),t("h2",{attrs:{id:"_2-变量作用域"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-变量作用域"}},[v._v("#")]),v._v(" 2. 变量作用域")]),v._v(" "),t("blockquote",[t("p",[v._v("一个变量的作用域：程序源代码中定义这个变量的区域")])]),v._v(" "),t("p",[v._v("全局变量拥有全局作用域，函数内声明的变量只在函数体内有定义（局部变量，作用域是局部性的），函数参数也是局部变量。")]),v._v(" "),t("p",[v._v("在函数体内，"),t("strong",[v._v("局部变量的优先级高于同名的全局变量")]),v._v("。如果同名，全局变量被局部变量所覆盖")]),v._v(" "),t("p",[t("img",{attrs:{src:"https://giriawsh-bucket.oss-cn-beijing.aliyuncs.com/img/20200922222448.png",alt:"image-20200922222440903"}})]),v._v(" "),t("p",[v._v("尽管在全局作用域编写代码时可以不写var语句，但生命局部变量时必须使用var语句（不然可能带有泄漏局部变量的风险）")]),v._v(" "),t("p",[t("img",{attrs:{src:"https://giriawsh-bucket.oss-cn-beijing.aliyuncs.com/img/20200922223529.png",alt:"image-20200922223529787"}})]),v._v(" "),t("p",[v._v("可以看到如果没有在函数作用域内用var重新声明，内部的局部变量值泄漏到了全局。")]),v._v(" "),t("p",[v._v("函数定义也可以嵌套，每个函数都有自己的作用域。")]),v._v(" "),t("h3",{attrs:{id:"_2-1-函数作用域和声明提前"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-函数作用域和声明提前"}},[v._v("#")]),v._v(" 2.1 函数作用域和声明提前")]),v._v(" "),t("blockquote",[t("p",[v._v("块级作用域：在类似C语言的编程语言中，花括号内的每一段代码都具有各自的作用域，并且变量在声明它们的代码段之外是不可见的")])]),v._v(" "),t("p",[v._v("JS中没有块级作用域，取而代之地使用了函数作用域。")]),v._v(" "),t("blockquote",[t("p",[v._v("函数作用域：变量在声明它们的函数体以及这个函数体嵌套的任意函数体内都是有定义的。")])]),v._v(" "),t("p",[v._v("在函数内声明的所有变量在函数体内始终是可见的。")]),v._v(" "),t("p",[v._v("这意味着，变量在声明之前甚至已经可用。JS的这个特性被非正式地成为"),t("strong",[v._v("声明提前")]),v._v("(代码运行开始之前完成，预编译阶段)")]),v._v(" "),t("blockquote",[t("p",[v._v("声明提前：JS函数里声明的所有变量（但不涉及赋值）都被“提前”至函数体的顶部")])]),v._v(" "),t("p",[t("img",{attrs:{src:"https://giriawsh-bucket.oss-cn-beijing.aliyuncs.com/img/20200922230319.png",alt:"image-20200922230319362"}})]),v._v(" "),t("p",[t("img",{attrs:{src:"https://giriawsh-bucket.oss-cn-beijing.aliyuncs.com/img/20200922230232.png",alt:"image-20200922230232712"}})]),v._v(" "),t("p",[v._v("一开始觉得有点惊讶，实际试验以后发现的却是这样。如果函数体内重新声明了变量，它的声明会被提前，赋值不会。")]),v._v(" "),t("p",[v._v("由于函数作用域的特性，局部变量在整个函数体始终是有定义的。但是只有执行到var语句的时候，局部变量才会被真正赋值。它的等价表现如下（声明提前，赋值保留原始位置）：")]),v._v(" "),t("p",[t("img",{attrs:{src:"https://giriawsh-bucket.oss-cn-beijing.aliyuncs.com/img/20200922230514.png",alt:"image-20200922230514238"}})]),v._v(" "),t("p",[v._v("在JS中没有块级作用域，一些程序员特意将变量声明放在函数体顶部，可以使得源代码更加清晰地反映真实的变量作用域。")]),v._v(" "),t("h3",{attrs:{id:"_2-2-作为属性的变量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-作为属性的变量"}},[v._v("#")]),v._v(" 2.2 作为属性的变量")]),v._v(" "),t("p",[v._v("之前我们提到过全局对象，当声明一个JS全局变量时，实际上是定义了全局对象的一个属性。")]),v._v(" "),t("p",[v._v("如果使用了var声明变量，创建的这个属性时不可配置的，无法通过delete运算符删除。")]),v._v(" "),t("p",[v._v("如果在非严格模式下，并给未声明的变量赋值，JS会自动创建一个全局变量，这种方式创建的全局变量时可配置属性，并且可以通过delete删除。")]),v._v(" "),t("p",[t("img",{attrs:{src:"https://giriawsh-bucket.oss-cn-beijing.aliyuncs.com/img/20200922230803.png",alt:"image-20200922230803723"}})]),v._v(" "),t("p",[v._v("但是对于局部变量，没有这个规定。局部变量当做跟函数调用相关的某个对象的属性。")]),v._v(" "),t("p",[v._v("ES5中称为“"),t("strong",[v._v("声明上下文对象")]),v._v("”。")]),v._v(" "),t("p",[v._v("JS允许使用this来引用全局对象，this.xxx引用全局对象的某个属性（或者说某个全局变量），却没有方法可以引用局部变量中存放的对象。")]),v._v(" "),t("p",[v._v("这种存放局部变量的对象的特有性质，是一种我们不可见的内部实现。")]),v._v(" "),t("h3",{attrs:{id:"_2-3-作用域链-重点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-作用域链-重点"}},[v._v("#")]),v._v(" 2.3 作用域链（重点）")]),v._v(" "),t("p",[v._v("根据上面可以知道，全局变量在程序中始终都是有定义的。局部变量在声明它的函数体内以及其所嵌套的函数内始终是有定义的。")]),v._v(" "),t("p",[v._v("根据2.2的性质，我们类似地可以把一个局部变量看做是自定义实现的对象的属性（就像全局变量是全局对象的属性一样）。")]),v._v(" "),t("p",[v._v("每一段JS代码都有一个与之关联的作用域链。这个作用域链是一个对象列表或者链表，这组对象定义了这段代码“作用域”中的变量。")]),v._v(" "),t("blockquote",[t("p",[v._v("变量解析：JS查找变量x的过程")])]),v._v(" "),t("p",[v._v("进行变量解析时，会从链中的第一个对象开始查找。如果有x属性，就会直接使用这个。如果不存在，会继续查找链上的下一个对象（相当于从函数内部往外找）。如果没有任何一个对象含有x属性，那么认为这段代码作用域链上不存在x，抛出引用错误异常。")]),v._v(" "),t("ul",[t("li",[v._v("在最顶层代码中，作用域链由一个全局对象组成（很好理解，所有变量都是全局对象的属性）。")]),v._v(" "),t("li",[v._v("在不包含嵌套的函数体内，作用域链上有两个对象\n"),t("ul",[t("li",[v._v("第一个是定义函数参数和局部变量的对象")]),v._v(" "),t("li",[v._v("第二个是全局对象（也很好理解，如果要找x，先找函数体内再找外面的全局对象内）")])])]),v._v(" "),t("li",[v._v("在一个嵌套的函数体内，作用域上至少有三个对象")])]),v._v(" "),t("p",[v._v("这里可以参考："),t("a",{attrs:{href:"https://juejin.im/post/6844903797135769614",target:"_blank",rel:"noopener noreferrer"}},[v._v("深入理解JavaScript作用域和作用域链"),t("OutboundLink")],1)]),v._v(" "),t("p",[t("strong",[v._v("对象链的创建规则：")])]),v._v(" "),t("p",[v._v("当定义一个函数时，它实际上保存一个作用域链。当调用这个函数时，它创建一个新的对象来存储它的局部变量，并将这个对象添加至保存的那个作用域链上，同时创建一个新的更长的表示函数调用作用域的“链”。")]),v._v(" "),t("p",[v._v("对于嵌套函数来说，"),t("strong",[v._v("每次调用外部函数时，内部函数又会重新定义一遍")]),v._v("。因为"),t("strong",[v._v("每次调用外部函数的时候作用域链都是不同的")]),v._v("，内部函数在每次定义的时候都会有微妙的差别。")]),v._v(" "),t("p",[v._v("总结来说："),t("strong",[v._v("在每次调用外部函数时，内部函数的代码都是相同的，但是关联这段代码的作用域链将会是不相同的，因此内部函数在每次定义时都会有微妙的不同。")])]),v._v(" "),t("p",[v._v("PS：不得不吐槽下中文书翻译，这里建议看原版。")]),v._v(" "),t("p",[t("img",{attrs:{src:"https://giriawsh-bucket.oss-cn-beijing.aliyuncs.com/img/20200923011322.png",alt:"image-20200923011322623"}})]),v._v(" "),t("p",[t("img",{attrs:{src:"https://giriawsh-bucket.oss-cn-beijing.aliyuncs.com/img/20200923011414.png",alt:"image-20200923011414788"}})]),v._v(" "),t("p",[v._v("我吐啦这翻译，我来回看了好几遍……")])])}),[],!1,null,null,null);_.default=a.exports}}]);